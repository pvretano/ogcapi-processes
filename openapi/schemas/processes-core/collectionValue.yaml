allOf:
  - $ref: format.yaml
  - type: object
    required:
      - collection
    properties:
      collection:
        description: |-
           The URI of the OGC API collection that should be accessed to provide
           input values from the corresponding process input.  The server
           offering this collection is referred to as the "value source server".
        type: string
        format: uri-reference
      bbox:
        description: |-
          Only resources that have a geometry that intersects the bounding box
          are selected.  The bounding box is provided as four or six numbers,
          depending on whether the coordinate reference system includes a
          vertical axis (height or depth):
    
          * Lower left corner, coordinate axis 1
          * Lower left corner, coordinate axis 2
          * Minimum value, coordinate axis 3 (optional)
          * Upper right corner, coordinate axis 1
          * Upper right corner, coordinate axis 2
          * Maximum value, coordinate axis 3 (optional)
    
          If the value consists of four numbers, the coordinate reference
          system is WGS84 longitude/latitude
            (http://www.opengis.net/def/crs/OGC/1.3/CRS84)
          unless a different coordinate reference system is specified in the
          parameter `bboxCrs`.
    
          If the value consists of six numbers, the coordinate reference system
          is WGS84 (http://www.opengis.net/def/crs/OGC/0/CRS84h) longitude/
          latitude/ ellipsoidal height unless a different coordinate reference
          system is specified in the parameter `bboxCrs`.
    
          For WGS84 longitude/latitude the values are in most cases the sequence
          of minimum longitude, minimum latitude, maximum longitude and maximum
          latitude.  However, in cases where the box spans the antimeridian the
          first value (west-most box edge) is larger than the third value
          (east-most box edge).
        
          If the vertical axis is included, the third and the sixth number are
          the bottom and the top of the 3-dimensional bounding box.
        
          If a resource has multiple spatial geometry properties, it is the
          decision of the server whether only a single spatial geometry property
          is used to determine the extent or all relevant geometries.
        type: array
        oneOf:
          - minItems: 4
            maxItems: 4
          - minItems: 6
            maxItems: 6
        items:
          type: number
      bboxCrs:
        description: |-
          Asserts the CRS used for the coordinate values of the `bbox`
          parameter.  The default is WGS 84 or WGS84h depending on whether 
          ellipsoidal height is included or not:
            * WGS 84 longitude/latitude [4 numbers]
              (http://www.opengis.net/def/crs/OGC/1.3/CRS84)
            * WGS 84h longitude/latitude/ellipsoidal height [6 numbers]
              (http://www.opengis.net/def/crs/OGC/0/CRS84h_
        type: string
        format: uri
      geometry:
         description: |-
          Only resources that have a geometry that intersects the geometry
          specified using the `geometry` parameter are selected.  The value of
          the `geometry` parameter can be specified using WKT or GeoJSON.
          If a resource has multiple spatial geometry properties, it is the
          decision of the server whether only a single spatial geometry property
          is used to determine the extent or all relevant geometries.
         oneOf:
           - type: string
           - $ref: "https://schemas.opengis.net/ogcapi/features/part1/1.0/openapi/schemas/geometryGeoJSON.yaml"
      geometryCrs:
        description: |-
          Asserts the CRS used for the coordinate values of the `geometry`
          parameter.  The default is WGS 84 or WGS84h depending on whether 
          ellipsoidal height is included or not:
            * WGS 84 longitude/latitude [4 numbers]
              (http://www.opengis.net/def/crs/OGC/1.3/CRS84)
            * WGS 84h longitude/latitude/ellipsoidal height [6 numbers]
              (http://www.opengis.net/def/crs/OGC/0/CRS84h_
        type: string
      datetime:
        description: |-
          Either a date-time or an interval, half-bounded or bounded. Date and
          time expressions adhere to RFC 3339. Half-bounded intervals are
          expressed using double-dots.
    
          Examples:
            * A date-time:
              "2018-02-12T23:20:50Z"
            * A bounded interval:
              "2018-02-12T00:00:00Z/2018-03-18T12:31:12Z"
            * Half-bounded intervals:
              "2018-02-12T00:00:00Z/.." or "../2018-03-18T12:31:12Z"
    
          Only resources that have a temporal property that intersects the
          value of `datetime` are selected.
    
          If a resource has multiple temporal properties, it is the decision of
          the server whether only a single temporal property is used to
          determine the extent or all relevant temporal properties.
        type: string
      limit:
        description: |-
          The optional limit parameter limits the number of items that are
          presented in the response document.
          Only items are counted that are on the first level of the collection
          in the response document.  Nested objects contained within the
          explicitly requested items shall not be counted.
        type: integer
        minimum: 1
        maximum: 10000
        default: 10
      crs:
        description: |-
          If the parameter is specified, then the coordinates of all
          geometry-valued properties in the response document are in
          the requested CRS. Otherwise the coordinates are in the default CRS,
          that is http://www.opengis.net/def/crs/OGC/1.3/CRS84 for coordinates
          without height and http://www.opengis.net/def/crs/OGC/0/CRS84h for
          coordinates with ellipsoidal height.
        type: string
        format: uri
      filter:
        description: |- 
           A search or filter condition.  This condition determines which
           resources from the OGC API collection are included in the result
           set and are thus passed as values to the corresponding process input.
           The `filter` parameter can be a string where the search condition is
           encoded in some text-based query langauge (e.g. cql2-text) or a
           CQL2 JSON object that encodes the search condition using JSON.
        oneOf:
          - type: string
          - $ref: "https://schemas.opengis.net/cql2/1.0/cql2.json"
      filterCrs:
        description: |-
          Asserts the CRS used for the coordinate values of the `filter`
          parameter.  The default is WGS 84 or WGS 84h depending on whether
          ellispoidal jeight is included with the coordinates or not:
            * WGS 84 longitude/latitude
              (http://www.opengis.net/def/crs/OGC/1.3/CRS84)
            * WGS 84h longitude/latitude/ellipsoidal height
              (http://www.opengis.net/def/crs/OGC/0/CRS84h_
        type: string
        format: uri-reference
      filterLang:
        description: |-
           Indicates the language used to encode a filter expression specified
           using the `filter` parameter. Query languages can include CQL2 text,
           CQL 2 JSON or OGC Filter Encoding (XML).
        type: string
        enum: 
        - cql2-text
        - cql2-json
        - fes-xml
      subset:
        description: |-
          Retrieve only part of the data by slicing or trimming along one or
          more axis. For trimming: {axisAbbrev}({low}:{high}) (preserves
          dimensionality). An asterisk (`*`) can be used instead of {low} or
          {high} to indicate the minimum/maximum value. For slicing:
          {axisAbbrev}({value}) (reduces dimensionality).
        type: array
        items:
          type: string
      subsetCrs:
        description: |-
          Asserts the CRS used for the coordinate values of the `subset`
          parameter.  The default is WGS 84 or WGS 84h depending on whether
          ellispoidal height in included with the coordinates or not:
            * WGS 84 longitude/latitude
              (http://www.opengis.net/def/crs/OGC/1.3/CRS84)
            * WGS 84h longitude/latitude/ellipsoidal height
              (http://www.opengis.net/def/crs/OGC/0/CRS84h_
        type: string
      ids:
        description: |-
          The optional ids parameter allows a specific list of resources,
          indicated by their identifiers, to be fetched from the OGC API
          collection. Only resources whose identifier matches one of the
          values listed for this parameter shall appear in the result set.
        type: array
        items:
          type: string
      q:
        description: |-
          The optional q parameter supports keyword searching.  Only resources
          whose text fields contain one or more of the specified search terms
          are selected.  The specific set of text keys/fields/properties of a
          resource to which the q operator is applied is up to the discretion
          of the server.   Implementations should, however, apply the q
          operator to the title, description and keywords keys/fields/properties
          if they exist in the resource.
        type: array
        items:
          type: string
      assets:
        description: |-
          A list of STAC asset tags.
        type: array
        items:
          type: string
      properties:
        description: |-
          A filter that selects resource properties to be included in a
          response document.  The elements in the `properties` parameter can
          be the names of resource properties, aliases for resources properties
          or synthetic properties.  Synthetic properties are properties that
          are computed on the fly and can reference resource property names
          or aliases for resource properties.
        type: array
        items:
          type: string
      aliases:
        description: |-
          A dictionary of aliases that can be used as values for the 
          `properties` parameter.  Aliases can be alternative names for
          resource properties or synthetic properties.  Synthetic properties
          are named expressions that are computed at run-time.  Expressions
          for synthetic properties are encoded using some expression language
          and can include references to resource property names or aliases
          for resource properties..
        type: object
        additionalProperties:
          oneOf:
            - type: string
            - type: object
              properties:
                expressionLang:
                  type: string
                  enum: 
                  - cql2-text
                  - cql2-json
                expression:
                  oneOf:
                    - type: string
                    - $ref: "https://schemas.opengis.net/cql2/1.0/cql2.json"
      passThruParameters:
        description: |-
          Parameters specified in this object are passed through to the value
          source server for processing on that server.  The keys used in this
          object should be identical to query parameters that the value source
          server would recognize.  In the case where the OAProc server supports
          local filtering, the `passThruParameters` parameter provides a
          mechanism to force filtering to happen on the value source server.
        type: object
